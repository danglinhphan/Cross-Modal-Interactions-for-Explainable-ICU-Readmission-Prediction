# ICU Readmission Prediction: Honest Glassbox Ensemble

## Overview
This repository contains the final model and documentation for the **Explainable ICU Readmission Prediction Project**. 
The goal was to build a model that is not only **accurate** (High F1 Score) but also **transparent** (Glassbox) and **reliable** (No Data Leakage).

### Key Achievement: Cross-Modal Synergy
Our Champion Model achieves superior performance by interpreting the *interactions* between clinical data and nursing notes, rather than analyzing them in isolation.
- **Precision**: **87.50%** (High trust, few false alarms)
- **Recall**: **82.17%** (Sensitive, misses few readmissions)
- **F1 Score**: **0.848**

## Repository Structure

### 1. Model & Insights
- `ebm_final_glassbox_ensemble.pkl`: The final trained model (Ensemble of 5 Explainable Boosting Machines).
- `final_interaction_list_ensemble.txt`: A list of the top 100 discovered risk patterns (e.g., "High Glucose x Insulin Mention").
- `full_metrics.txt`: Detailed performance report.

### 2. Reproducibility (Code)
To ensure scientific rigor, we include the exact scripts used to train the model:
- `train_phase17_glassbox.py`: Main Training Script.
- `train_phase16_honest.py`: Data Loading & Leakage Removal.
- `extract_*.py`: Feature Extraction scripts.

### 3. Scientific Validation (Ablation Study)
To prove the value of our approach, we compared it against simpler baselines (Results in `Baselines/` folder):

| Model Approach | F1 Score | Insight |
| :--- | :--- | :--- |
| **Clinical Only** | ~0.72 | Good sensitivity, but high false alarm rate. |
| **Text Only** | ~0.46 | Sparse, lacks continuity. |
| **Interaction Only**| ~0.63 | Excellent at spotting specific risks, but lacks context. |
| **Combined (Final)**| **~0.85**| **Synergy**: Combines sensitivity of data with context of notes. |

## Usage
The model is saved as a standard Python pickle file.

```python
import pickle
import pandas as pd

# Load Model
with open('ebm_final_glassbox_ensemble.pkl', 'rb') as f:
    model = pickle.load(f)

# Predict
# probas = model.predict_proba(X_new)[:, 1]
```

## Contact
Generated by VRES Optimization Team.
