# Final Deliverables: Honest Glassbox Ensemble (Phase 17)

## Overview
This folder contains the complete artifacts for the **ICU Readmission Prediction Model (Phase 17)**. 
This model is the "Champion" of the project, selected for combining **High Performance** with **Scientific Integrity**.

### Key Highlights
- **Architecture**: Ensemble of 5 Explainable Boosting Machines (Glassbox).
- **Integrity**: NO DATA LEAKAGE (Future info like `Ward LOS` removed). NO SYNTHETIC DATA (No SMOTE).
- **Performance**:
    - **Precision**: **87.50%**
    - **Recall**: **82.17%**
    - **F1 Score**: **0.848**

## Contents

### 1. Model Artifacts
- `ebm_final_glassbox_ensemble.pkl`: The trained model ensemble (Pickle). Wrapped to use optimal threshold (0.7915).
- `final_interaction_list_ensemble.txt`: Top 100 clinical interactions discovered by the model, averaged across 5 estimators.
- `full_metrics.txt`: Comprehensive classification report and confusion matrix.

### 2. Source Code (Reproducibility)
- `train_phase17_glassbox.py`: The main script used to train the ensemble.
- `finalize_glassbox.py`: Script to wrap the model and extract interactions.
- `train_phase16_honest.py`: Dependency (Data Loader for honest features).
- `train_phase14_social.py`: Dependency (Data Loader for social features).
- `train_phase12_nosmote.py`: Dependency (Data Loader for clinical/text features).

### 3. Data Extraction (Reference)
- `extract_phase14_social.py`: Script used to extract Social Determinants (Admission/Discharge/Insurance).
- `extract_phase12_features.py`: Script used to extract High-Fidelity Clinical Features (Fluids, Micro).

### 4. Ablation Study (For Publication)
Located in `Baselines/` folder.
- `train_baselines_publish.py`: Script to train Clinical-Only and Text-Only models.
- `train_interaction_only_publish.py`: Script to train Model using ONLY Top 50 Interactions (No Main Effects).
- **Results**:
    - Clinical Only: F1 ~0.72 (Rec 87% / Prec 61%)
    - Text Only: F1 ~0.46
    - Interaction Only (Top 50): F1 ~0.63 (Rec 86% / Prec 50%)
    - **Combined (Phase 17)**: F1 ~0.85
    - *Conclusion*: Synergy is real. Interactions alone are sensitive (Rec 86%) but noisy. Adding them to Clinical Features boosts Precision significantly (60% -> 87%).

## Usage
To use the model for inference in Python:

```python
import pickle
import pandas as pd

# Load Model
with open('ebm_final_glassbox_ensemble.pkl', 'rb') as f:
    model = pickle.load(f)

# Predict (Assumes X is prepared using same pipeline)
# X_new = ...
# probas = model.predict_proba(X_new)[:, 1]
# preds = model.predict(X_new)  # Uses threshold 0.7915
```

## Contact
Generated by VRES optimization pipeline (Phase 17).
